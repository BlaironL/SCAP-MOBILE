<ion-header class="ion-no-border">
  <ion-toolbar color="primary">
    <ion-title color="light">Avaliação de Projetos</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <!-- Título e descrição -->
  <div class="header-text">
    <h2>Projetos Pendentes</h2>
    <p>Selecione um projeto para atribuir notas.</p>
  </div>

  <!-- Lista de Projetos -->
  <ion-list class="evaluation-list" lines="none">
    <ion-item 
      *ngFor="let projeto of projetosPendentes"
      class="project-item"
    >
      <ion-label>
        <div class="category-badge">{{ projeto.categoria }}</div>

        <h3>{{ projeto.titulo }}</h3>

        <p class="author">
          <ion-icon name="person-circle-outline"></ion-icon>
          {{ projeto.autor }}
        </p>
      </ion-label>

      <ion-button 
        slot="end" 
        fill="solid" 
        color="secondary"
        (click)="abrirAvaliacao(projeto)"
      >
        Avaliar
        <ion-icon slot="end" name="chevron-forward-outline"></ion-icon>
      </ion-button>
    </ion-item>
  </ion-list>

  <!-- Estado vazio -->
  <div class="empty-state" *ngIf="projetosPendentes.length === 0">
    <ion-icon name="checkmark-done-circle-outline"></ion-icon>
    <h3>Tudo em dia!</h3>
    <p>Você não tem avaliações pendentes.</p>
  </div>

  <!-- Modal -->
  <ion-modal [isOpen]="isModalOpen" (didDismiss)="cancelar()">
    <ng-template>

      <ion-header>
        <ion-toolbar color="light">
          <ion-buttons slot="start">
            <ion-button color="medium" (click)="cancelar()">Cancelar</ion-button>
          </ion-buttons>
          <ion-title>Ficha de Avaliação</ion-title>
        </ion-toolbar>
      </ion-header>

      <ion-content class="ion-padding">

        <!-- Informações do Projeto -->
        <div class="modal-project-info">
          <h2>{{ avaliacaoAtual.titulo }}</h2>
          <div class="media-badge">
            Média: {{ mediaAtual | number:'1.1-1' }}
          </div>
        </div>

        <!-- Formulário de Notas -->
        <div class="criteria-form">

          <div class="criteria-item">
            <ion-label>
              Originalidade
              <span class="nota-valor">{{ avaliacaoAtual.notas.originalidade }}</span>
            </ion-label>
            <ion-range
              [min]="0" [max]="10" [step]="0.5"
              [ticks]="false" [snaps]="true"
              [(ngModel)]="avaliacaoAtual.notas.originalidade"
              color="primary"
            ></ion-range>
          </div>

          <div class="criteria-item">
            <ion-label>
              Relevância
              <span class="nota-valor">{{ avaliacaoAtual.notas.relevancia }}</span>
            </ion-label>
            <ion-range
              [min]="0" [max]="10" [step]="0.5"
              [snaps]="true"
              [(ngModel)]="avaliacaoAtual.notas.relevancia"
              color="primary"
            ></ion-range>
          </div>

          <div class="criteria-item">
            <ion-label>
              Metodologia
              <span class="nota-valor">{{ avaliacaoAtual.notas.metodologia }}</span>
            </ion-label>
            <ion-range
              [min]="0" [max]="10" [step]="0.5"
              [snaps]="true"
              [(ngModel)]="avaliacaoAtual.notas.metodologia"
              color="primary"
            ></ion-range>
          </div>

          <div class="criteria-item">
            <ion-label>
              Apresentação
              <span class="nota-valor">{{ avaliacaoAtual.notas.apresentacao }}</span>
            </ion-label>
            <ion-range
              [min]="0" [max]="10" [step]="0.5"
              [snaps]="true"
              [(ngModel)]="avaliacaoAtual.notas.apresentacao"
              color="primary"
            ></ion-range>
          </div>

          <!-- Comentário -->
          <ion-item class="comment-box" lines="none">
            <ion-textarea
              label="Parecer Final (Opcional)"
              labelPlacement="floating"
              fill="outline"
              placeholder="Justifique sua nota..."
              rows="4"
              [(ngModel)]="avaliacaoAtual.comentario"
            ></ion-textarea>
          </ion-item>

          <!-- Botão -->
          <ion-button 
            expand="block"
            shape="round"
            class="submit-btn"
            (click)="confirmar()"
          >
            Concluir Avaliação
            <ion-icon slot="end" name="checkmark-done-circle-outline"></ion-icon>
          </ion-button>

        </div>
      </ion-content>

    </ng-template>
  </ion-modal>

</ion-content>
